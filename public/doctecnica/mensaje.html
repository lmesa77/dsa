
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://lmesa.gitlab.io/doc-nueva-arquitectura/doctecnica/mensaje.html">
      
      
        <link rel="prev" href="documentacion.html">
      
      
        <link rel="next" href="componentes.html">
      
      
      <link rel="icon" href="../assets/logo.svg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>La Clase BaseMessage - Nueva Arquitectura</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Poppins";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduccion" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../index.html" title="Nueva Arquitectura" class="md-header__button md-logo" aria-label="Nueva Arquitectura" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nueva Arquitectura
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              La Clase BaseMessage
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Claro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Claro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 6v12h8V6H8m6 4h-4V8h4v2m5.4-8.4C19 1.2 18.5 1 18 1H6c-.5 0-1 .2-1.4.6C4.2 2 4 2.5 4 3v18c0 .5.2 1 .6 1.4.4.4.9.6 1.4.6h12c.5 0 1-.2 1.4-.6.4-.4.6-.9.6-1.4V3c0-.5-.2-1-.6-1.4M18 21H6V3h12v18Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="black"  aria-label="Oscuro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Oscuro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.4 1.6C19 1.2 18.5 1 18 1H6c-.5 0-1 .2-1.4.6C4.2 2 4 2.5 4 3v18c0 .5.2 1 .6 1.4.4.4.9.6 1.4.6h12c.5 0 1-.2 1.4-.6.4-.4.6-.9.6-1.4V3c0-.5-.2-1-.6-1.4M18 21H6V3h12v18M8 6v12h8V6H8m7 11H9V7h6v10m-5-3h4v2h-4v-2Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Nueva Arquitectura" class="md-nav__button md-logo" aria-label="Nueva Arquitectura" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    Nueva Arquitectura
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contexto
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Definiciones
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Definiciones
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../definiciones.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arquitectura de dominio basada en Microservicios
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../serv-app.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Servidor de Aplicaciones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../venta-contenido.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Venta de contenidos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dicc-datos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diccionario de datos
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../bitacora.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bitácora
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../inventario.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inventarios
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../poc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pruebas de concepto
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../glosario.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glosario
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../links.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Links de Interés
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../backlog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backlog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Documentación Técnica
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Documentación Técnica
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="documentacion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arquitectura de Servicios de Dominio DSA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    La Clase BaseMessage
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="mensaje.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    La Clase BaseMessage
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cabecera-o-header" class="md-nav__link">
    <span class="md-ellipsis">
      Cabecera o Header
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cabecera o Header">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operationtype" class="md-nav__link">
    <span class="md-ellipsis">
      OperationType
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suboperationtype" class="md-nav__link">
    <span class="md-ellipsis">
      SubOperationType
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traceid" class="md-nav__link">
    <span class="md-ellipsis">
      TraceId
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#messagestatus" class="md-nav__link">
    <span class="md-ellipsis">
      MessageStatus
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cuerpo-o-datasection" class="md-nav__link">
    <span class="md-ellipsis">
      Cuerpo o DataSection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uso-de-la-clase-basemessage" class="md-nav__link">
    <span class="md-ellipsis">
      Uso de la clase BaseMessage
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="componentes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Componentes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="excepciones.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manejo de excepciones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="estructura-carpetas.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estructura de Carpetas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="trazabilidad.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trazabilidad Operativa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="arquitectura-limpia.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arquitectura Limpia
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="patron-pipeline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Patrón Pipeline
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cabecera-o-header" class="md-nav__link">
    <span class="md-ellipsis">
      Cabecera o Header
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cabecera o Header">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operationtype" class="md-nav__link">
    <span class="md-ellipsis">
      OperationType
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suboperationtype" class="md-nav__link">
    <span class="md-ellipsis">
      SubOperationType
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traceid" class="md-nav__link">
    <span class="md-ellipsis">
      TraceId
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#messagestatus" class="md-nav__link">
    <span class="md-ellipsis">
      MessageStatus
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cuerpo-o-datasection" class="md-nav__link">
    <span class="md-ellipsis">
      Cuerpo o DataSection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uso-de-la-clase-basemessage" class="md-nav__link">
    <span class="md-ellipsis">
      Uso de la clase BaseMessage
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="introduccion">Introducción</h1>
<p>Para el intercambio de información entre componentes internos y externos, se diseñó un objeto de valor denominado <code>BaseMessage</code>. Su propósito es proporcionar un <code>wrapper</code> de datos consistente y transversal para toda la información que circula dentro de la arquitectura. A continuación, se detalla su estructura y uso:</p>
<h2 id="cabecera-o-header">Cabecera o <em>Header</em></h2>
<p>La cabecera (header) del mensaje consta de cuatro elementos:</p>
<h3 id="operationtype">OperationType</h3>
<p>Define el tipo de operación al que pertenece el mensaje, clasificándolo en uno de los tres grupos principales: <em>venta</em>, <em>no venta</em> o <em>pago</em>. Es inmutable.</p>
<h3 id="suboperationtype">SubOperationType</h3>
<p>Especifica las operaciones detalladas dentro de cada tipo de operación. Estas guían a la DSA en el flujo a seguir e indican los datos complementarios necesarios para cada caso. Es inmutable.</p>
<h3 id="traceid">TraceId</h3>
<p>Es un identificador único utilizado en sistemas distribuidos para rastrear el recorrido de una solicitud a través de múltiples servicios o componentes. Su propósito es simplificar el monitoreo y la depuración en entornos complejos. Este identificador debe generarse al inicio de la solicitud, ya sea por el cliente o por el adaptador de entrada de la arquitectura. Se utiliza el formato estándar UUID (Universally Unique Identifier) para garantizar unicidad y consistencia en el sistema. Es inmutable.</p>
<h3 id="messagestatus">MessageStatus</h3>
<p>Es un enumerador que indica el estado actual del mensaje, con tres posibles valores: <code>OK</code>, <code>NOK</code> y <code>ERROR</code>.</p>
<ul>
<li><strong>OK</strong>: Estado inicial del mensaje al ser creado. Si el flujo no presenta inconvenientes, permanecerá en este estado hasta su finalización (<em>happy path</em>).</li>
</ul>
<div class="language-json highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Representación de un mensaje OK</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">  </span><span class="nt">&quot;operationType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NOSELL&quot;</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">  </span><span class="nt">&quot;subOperationType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RECHARGE&quot;</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">  </span><span class="nt">&quot;traceId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fb4bbc82-beef-43dc-9f34-4d858cd52c99&quot;</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">  </span><span class="nt">&quot;messageStatus&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OK&quot;</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">  </span><span class="nt">&quot;dataSection&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">    </span><span class="nt">&quot;sections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">      </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">        </span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;20240725&quot;</span><span class="p">,</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">        </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10000&quot;</span><span class="p">,</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">        </span><span class="nt">&quot;terminalId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0160&quot;</span><span class="p">,</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">        </span><span class="nt">&quot;storeId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0013&quot;</span><span class="p">,</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">        </span><span class="nt">&quot;transactionId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0003&quot;</span><span class="p">,</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">        </span><span class="nt">&quot;plu&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;115192&quot;</span><span class="p">,</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">        </span><span class="nt">&quot;cashierId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0000011111&quot;</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">        </span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;144557&quot;</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">        </span><span class="nt">&quot;customer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li><strong>NOK</strong>: Indica una inconsistencia en el flujo debido a una violación prevista de las reglas de negocio. En este caso, el mensaje es marcado para ser ignorado en los procesos posteriores hasta la conclusión del flujo.</li>
</ul>
<div class="language-json highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Representación de un mensaje NOK</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">  </span><span class="nt">&quot;operationType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SELL&quot;</span><span class="p">,</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">  </span><span class="nt">&quot;subOperationType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SUBSCRIPTION&quot;</span><span class="p">,</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">  </span><span class="nt">&quot;traceId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fb4bbc82-beef-43dc-9f34-4d858cd52c99&quot;</span><span class="p">,</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">  </span><span class="nt">&quot;messageStatus&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NOK&quot;</span><span class="p">,</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">  </span><span class="nt">&quot;dataSection&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">    </span><span class="nt">&quot;sections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">      </span><span class="nt">&quot;errorMessage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PLS002: ERROR DEL PROCESO&quot;</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li><strong>ERROR</strong>: Representa una condición técnica inesperada, como una excepción. Este estado provoca que el flujo sea interrumpido, y el error es devuelto como una <code>Exception</code> mediante la clase <code>GlobalControllerAdvice</code>.</li>
</ul>
<div class="language-json highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Representación de un mensaje ERROR</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">  </span><span class="nt">&quot;operationType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SELL&quot;</span><span class="p">,</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">  </span><span class="nt">&quot;subOperationType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SUBSCRIPTION&quot;</span><span class="p">,</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">  </span><span class="nt">&quot;traceId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fb4bbc82-beef-43dc-9f34-4d858cd52c99&quot;</span><span class="p">,</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">  </span><span class="nt">&quot;messageStatus&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ERROR&quot;</span><span class="p">,</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">  </span><span class="nt">&quot;dataSection&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">    </span><span class="nt">&quot;sections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">      </span><span class="nt">&quot;errorMessage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DCS001: SERVICIO NO DISPONIBLE&quot;</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<h2 id="cuerpo-o-datasection">Cuerpo o <em>DataSection</em></h2>
<p>El <code>DataSection</code> del mensaje es una estructura mutable diseñada para transportar la carga útil de una operación específica. Su organización se basa en <strong>secciones</strong> con formato clave-valor (<code>Map&lt;String, Object&gt;</code>), lo que permite agregar diferentes tipos de datos, cada uno identificado por una clave única. Funciona como un <strong>contenedor de información</strong> que incluye pequeños <strong>contenedores rotulados</strong> llamados <code>section</code>, capaces de almacenar tanto objetos específicos como otros contenedores.</p>
<p>Si observamos el json de la <strong>representación de un mensaje OK</strong>, vemos que contiene una <em>sección</em> llamada <code>payload</code> la cual contiene a su vez un conjunto de datos. Esta sección es principal y debería contener los datos principales de cualquier petición hecha a la nueva arquitectura exceptuando en los casos donde el mensaje toma el estado <code>NOK</code> o <code>ERROR</code> en cuyo caso la sección se llamará <code>errorMessage</code>.</p>
<p>Es crucial gestionar eficientemente el contenido del <code>DataSection</code>, asegurando que los mensajes sean <em>suficientes</em> en términos de información contenida. Esto implica evitar duplicidad de datos, eliminación de información obsoleta para operaciones futuras y reducir el anidamiento innecesario.</p>
<p>La clase <code>BaseMessage</code> proporciona múltiples métodos para realizar operaciones <em>CRUD</em> sobre estos contenedores, facilitando su manipulación y organización.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>En el caso de los adaptadores, el <strong>Mensaje</strong> como objeto de transporte recibe un tratamiento especial, ya que estos adaptadores, por su naturaleza, deben comunicarse con las capas externas y con terceros en términos de sus respectivas APIs. Esto ocurre cuando no es posible que dichas capas o sistemas externos se adapten al esquema del <strong>Mensaje</strong> definido por la DSA. Los adaptadores tienen la responsabilidad de actuar como traductores entre las tecnologías externas y la DSA.</p>
</div>
<h2 id="uso-de-la-clase-basemessage">Uso de la clase BaseMessage</h2>
<p>La clase <code>BaseMessage</code> se encuentra en la librería <code>datacatalog</code>, la cual es importada por todos los proyectos que componen la DSA. Esto garantiza el uso consistente de las mismas entidades y estructuras de datos en todo el flujo de los procesos.</p>
<p>Se recomienda extender esta clase en una clase <code>Message</code> dentro de la capa de dominio de los componentes, en lugar de utilizarla directamente. De esta forma, se facilita el manejo de diferentes tipos de mensajes con un núcleo común, adaptado según el contexto.</p>
<p>La clase <code>BaseMessage</code> dispone de dos constructores: uno vacío, utilizado para procesos de serialización/deserialización, y otro que acepta tres argumentos: <code>operationType</code>, <code>subOperationType</code> y <code>traceId</code>. Al instanciar la clase, su variable <code>messageStatus</code> toma por defecto el valor <code>OK</code>.</p>
<p>La clase cuenta con dos métodos:</p>
<ul>
<li><code>setNOKStatus(String message)</code>: Cambia el estado del mensaje para que sea administrado por el flujo como error de regla de negocio.</li>
<li><code>setErrorStatus(String message)</code>: Cambia el estado del mensaje para que sea administrado por el flujo de excepciones.</li>
</ul>
<p>Una vez creado el objeto <code>Message</code>, se debe agregar la <code>dataSection</code>. Esta clase también se encuentra en la librería <code>datacatalog</code> y contiene un atributo de tipo <code>HashMap&lt;String, Object&gt;</code>. <code>DataSection</code> proporciona un conjunto de métodos para su manipulación:</p>
<ul>
<li><code>DataSection()</code>: Constructor vacío que inicializa el atributo <code>HashMap&lt;String, Object&gt;</code>.</li>
<li><code>DataSection(String sectionName, Object data)</code>: Constructor con argumentos que inicializa el atributo <code>HashMap&lt;String, Object&gt;</code> y crea una <code>section</code> dentro del mapa.</li>
<li><code>addSection(String sectionKey, Object data)</code>: Agrega una <code>section</code> a un <code>dataSection</code> existente.</li>
<li><code>getSection(String sectionKey, Class&lt;T&gt; type)</code>: Recupera una <code>section</code> del <code>dataSection</code>, usando la clave y especificando el tipo de retorno esperado.</li>
<li><code>getSections()</code>: Recupera todas las <code>sections</code> que contiene el mensaje.</li>
<li><code>deleteSection(String sectionKey)</code>: Elimina una <code>section</code> específica.</li>
<li><code>deleteAllSections()</code>: Elimina todas las <code>sections</code> del <code>dataSection</code>.</li>
<li><code>toString()</code>: Representación en cadena del objeto.</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Se debe tener en cuenta que cualquier cambio realizado en uno de los componentes de la librería <code>datacatalog</code> afectará a todos los componentes que la importen. Por lo tanto, es importante realizar ajustes o cambios con cuidado para evitar impactos inesperados en otros módulos que dependan de ella.</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Linea Datascan
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>